# Feature Specification: カビゴン評価ランクデータの実データ対応

**Feature Branch**: `030-update-snorlax-ratings`
**Created**: 2026-02-08
**Status**: Draft
**Input**: User description: "カビゴン評価のデータを本物のゲームデータに合わせて更新する"

## User Scenarios & Testing *(mandatory)*

### User Story 1 - 正確なカビゴン評価ランク一覧の閲覧 (Priority: P1)

ユーザーがフィールド詳細ページでカビゴン評価ランク一覧を確認したとき、ポケモンスリープの実際のゲームデータと一致するランク名・必要エナジー・報酬（ゆめのかけら）が表示される。

現在のシステムでは6段階の独自ランク名（ノーマル、いいかんじ、すごいぞ、とてもすごい、ハイパー、マスター）を使用しているが、実際のゲームでは「ノーマル1～5」「スーパー1～5」「ハイパー1～5」「マスター1～20」の35段階で構成されている。また、各ランクにはゆめのかけらの報酬が存在するが、現在のデータモデルにはこのフィールドがない。

**Why this priority**: サイトの信頼性に直結する最重要タスク。ゲームと異なるデータが表示されると、ユーザーの信頼を損ない、攻略情報としての価値がなくなる。

**Independent Test**: フィールド詳細ページを開き、カビゴン評価ランク表の各ランク名・必要エナジー・報酬が実際のゲーム内表示と一致することを目視確認できる。

**Acceptance Scenarios**:

1. **Given** ユーザーがワカクサ本島の詳細ページを開いたとき, **When** カビゴン評価ランク表を確認する, **Then** ノーマル1からマスター20までの35段階のランクが表示され、各ランクの必要エナジーと報酬（ゆめのかけら数）がゲーム内データと一致している
2. **Given** ユーザーがシアンの砂浜の詳細ページを開いたとき, **When** カビゴン評価ランク表を確認する, **Then** フィールド固有の必要エナジー値が表示され、ワカクサ本島とは異なる値であることが確認できる
3. **Given** ユーザーがいずれかのフィールド詳細ページを確認したとき, **When** ランク表を確認する, **Then** 各ランクに報酬（ゆめのかけら）の数値が表示されている

---

### User Story 2 - ランク別出現ポケモンの正確な表示 (Priority: P2)

ユーザーがフィールド詳細ページでランク別の新規出現ポケモンを確認したとき、実際のゲームデータに基づく35段階のランクごとに正しいポケモンが表示される。

**Why this priority**: ランク別出現ポケモン情報はユーザーが目標ランクを設定する際の重要な参考情報。ランク構造が変わるため、出現ポケモンの紐付けも正しく更新する必要がある。

**Independent Test**: 各フィールドのランク別出現ポケモン一覧を表示し、特定のランクで初めて出現するポケモンが実際のゲームと一致することを確認できる。

**Acceptance Scenarios**:

1. **Given** ユーザーがフィールド詳細ページを開いたとき, **When** ランク別出現ポケモン一覧を確認する, **Then** 35段階のランクそれぞれに対応する新規出現ポケモンが正しく表示されている
2. **Given** 特定ランクで新規出現ポケモンがないとき, **When** そのランクの出現ポケモン欄を確認する, **Then** 「なし」と表示される

---

### Edge Cases

- 必要エナジーが0のランク（ノーマル1）が正しく表示されるか
- マスター20（最高ランク）のデータが正しく終端として扱われるか
- 報酬が0のランクが存在する場合の表示
- 各フィールドごとに必要エナジーが異なるため、全フィールドのデータが正しく独立して管理されているか

## Requirements *(mandatory)*

### Functional Requirements

- **FR-001**: システムは「ノーマル1～5」「スーパー1～5」「ハイパー1～5」「マスター1～20」の35段階のカビゴン評価ランクをサポートしなければならない
- **FR-002**: 各ランクにはランクティア名（ノーマル/スーパー/ハイパー/マスター）、ティア内番号（1～5 or 1～20）、必要エナジー、報酬（ゆめのかけら数）、新規出現ポケモンIDの情報を保持しなければならない
- **FR-003**: 必要エナジーと報酬はフィールドごとに異なる値を持たなければならない
- **FR-004**: ランク表には必要エナジー（カンマ区切りの数値）と報酬（ゆめのかけら数）の両方が表示されなければならない
- **FR-005**: 全フィールド（ワカクサ本島、シアンの砂浜、トープ洞窟、ウノハナ雪原、ラピスラズリ湖畔、ゴールド旧発電所）のカビゴン評価データが実際のゲームデータと一致しなければならない
- **FR-006**: ランク名の表示形式は「{ティア名} {番号}」（例：「ノーマル 3」「マスター 15」）でなければならない

### Key Entities

- **カビゴン評価ランク（SnorlaxRank）**: 各フィールドにおけるカビゴンの評価段階。ランクティア（ノーマル/スーパー/ハイパー/マスター）、ティア内番号、必要エナジー、報酬（ゆめのかけら）、新規出現ポケモンIDリストを持つ
- **ランクティア（RankTier）**: カビゴン評価の大分類。ノーマル（1-5）、スーパー（1-5）、ハイパー（1-5）、マスター（1-20）の4種類
- **フィールド（Island）**: リサーチフィールド。各フィールドごとに独自の35段階のカビゴン評価ランクデータを持つ

## Assumptions

- 現時点では既存の6フィールドのみを対象とする（アンバー渓谷やEXモードは将来対応）
- 報酬のゆめのかけら数はゲーム内の値を正確に反映する（計算式による概算ではなく実測値を使用）
- ランク構造（ノーマル5段階・スーパー5段階・ハイパー5段階・マスター20段階の計35段階）は全フィールドで共通
- 各ランクの必要エナジーと報酬はフィールドごとに異なるが、ランクの段階数と名称は共通

## Success Criteria *(mandatory)*

### Measurable Outcomes

- **SC-001**: 全6フィールドのカビゴン評価ランク表が35段階すべて表示され、ゲーム内のデータと100%一致している
- **SC-002**: 各ランクの必要エナジーと報酬（ゆめのかけら数）がゲーム内の表示と一致している
- **SC-003**: ランク別出現ポケモン情報が35段階の新ランク構造に正しく紐付いている
- **SC-004**: 既存のフィールド一覧ページ・詳細ページが正常に表示され、データ更新による表示崩れが発生しない

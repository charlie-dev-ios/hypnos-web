# アーキテクチャ

## 概要

Hashibiroko は Webアプリケーションです。
フロントエンド（Web）とバックエンド（API）は分離されています。

## システム構成

```
┌─────────────────┐     ┌─────────────────┐
│   Web (Next.js) │     │      Mobile     │
│     Vercel      │     │                 │
└────────┬────────┘     └────────┬────────┘
         │                       │
         └───────────┬───────────┘
                     │
                     ▼
         ┌───────────────────────┐
         │   API (Hono)          │
         │  Cloudflare Workers   │
         └───────────┬───────────┘
                     │
                     ▼
         ┌───────────────────────┐
         │   Database            │
         │   Supabase(PostgreSQL)│
         └───────────────────────┘
```

## リポジトリ構成

モノレポ構成で、複数のアプリケーションと共通パッケージを管理します。

詳細なディレクトリ構造は [開発ガイド](./development.md#プロジェクト構成) を参照してください。

**主要構成：**
- `apps/web` - Next.js Webフロントエンド
- `apps/api` - Hono APIバックエンド（開発中）
- `packages/shared` - 共通パッケージ（型定義・スキーマ）
- `specs/` - 機能仕様書（speckit）
- `.specify/` - speckit設定・開発原則

## アーキテクチャ上の設計決定

### フロントエンド・バックエンド分離

- **理由**: モバイルアプリとの共通API利用
- **メリット**: 独立したスケーリング、技術選択の柔軟性

### モノレポ構成

- **理由**: コード共有の容易さ、一貫した開発体験
- **ツール**: Turborepo（ビルドキャッシュ、並列実行）

### Edge-First戦略

- **フロントエンド**: Vercel（Next.js App Router）
- **バックエンド**: Cloudflare Workers（Hono）
- **メリット**: 低レイテンシ、グローバルな配信

## 通信フロー

```
[Web/Mobile] 
    │
    │ HTTPS (JSON)
    ▼
[Cloudflare Workers - Hono API]
    │
    │ - JWT 認証検証
    │ - リクエストバリデーション (Zod)
    │ - ビジネスロジック実行
    │ - レスポンス生成
    ▼
[Database]
```

